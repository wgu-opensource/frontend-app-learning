{"version":3,"file":"hooks.js","names":["_react","require","useEventListener","type","handler","eventListenerRef","useRef","useEffect","current","global","removeEventListener","addEventListener","useIFramePluginEvents","events","receiveMessage","useCallback","_ref","data","payload","useIFrameHeight","onIframeLoaded","arguments","length","undefined","iframeHeight","setIframeHeight","useState","hasLoaded","setHasLoaded","receiveResizeMessage","_ref2","height"],"sources":["../../src/generic/hooks.js"],"sourcesContent":["/* eslint-disable import/prefer-default-export */\n\nimport {\n  useCallback, useEffect, useRef, useState,\n} from 'react';\n\nexport function useEventListener(type, handler) {\n  // We use this ref so that we can hold a reference to the currently active event listener.\n  const eventListenerRef = useRef(null);\n  useEffect(() => {\n    // If we currently have an event listener, remove it.\n    if (eventListenerRef.current !== null) {\n      global.removeEventListener(type, eventListenerRef.current);\n      eventListenerRef.current = null;\n    }\n    // Now add our new handler as the event listener.\n    global.addEventListener(type, handler);\n    // And then save it to our ref for next time.\n    eventListenerRef.current = handler;\n    // When the component finally unmounts, use the ref to remove the correct handler.\n    return () => global.removeEventListener(type, eventListenerRef.current);\n  }, [type, handler]);\n}\n\n/**\n * Hooks up post messages to callbacks\n * @param {Object.<string, function>} events A mapping of message type to callback\n */\nexport function useIFramePluginEvents(events) {\n  const receiveMessage = useCallback(({ data }) => {\n    const {\n      type,\n      payload,\n    } = data;\n    if (events[type]) {\n      events[type](payload);\n    }\n  }, [events]);\n  useEventListener('message', receiveMessage);\n}\n\n/**\n * A hook to monitor message about changes in iframe content height\n * @param onIframeLoaded A callback for when the frame is loaded\n * @returns {[boolean, number]}\n */\nexport function useIFrameHeight(onIframeLoaded = null) {\n  const [iframeHeight, setIframeHeight] = useState(null);\n  const [hasLoaded, setHasLoaded] = useState(false);\n  const receiveResizeMessage = useCallback(({ height }) => {\n    setIframeHeight(height);\n    if (!hasLoaded && !iframeHeight && height > 0) {\n      setHasLoaded(true);\n      if (onIframeLoaded) {\n        onIframeLoaded();\n      }\n    }\n  }, [setIframeHeight, hasLoaded, iframeHeight, setHasLoaded, onIframeLoaded]);\n  useIFramePluginEvents({ 'plugin.resize': receiveResizeMessage });\n  return [hasLoaded, iframeHeight];\n}\n"],"mappings":";;;;;;;;AAEA,IAAAA,MAAA,GAAAC,OAAA;AAFA;;AAMO,SAASC,gBAAgBA,CAACC,IAAI,EAAEC,OAAO,EAAE;EAC9C;EACA,MAAMC,gBAAgB,GAAG,IAAAC,aAAM,EAAC,IAAI,CAAC;EACrC,IAAAC,gBAAS,EAAC,MAAM;IACd;IACA,IAAIF,gBAAgB,CAACG,OAAO,KAAK,IAAI,EAAE;MACrCC,MAAM,CAACC,mBAAmB,CAACP,IAAI,EAAEE,gBAAgB,CAACG,OAAO,CAAC;MAC1DH,gBAAgB,CAACG,OAAO,GAAG,IAAI;IACjC;IACA;IACAC,MAAM,CAACE,gBAAgB,CAACR,IAAI,EAAEC,OAAO,CAAC;IACtC;IACAC,gBAAgB,CAACG,OAAO,GAAGJ,OAAO;IAClC;IACA,OAAO,MAAMK,MAAM,CAACC,mBAAmB,CAACP,IAAI,EAAEE,gBAAgB,CAACG,OAAO,CAAC;EACzE,CAAC,EAAE,CAACL,IAAI,EAAEC,OAAO,CAAC,CAAC;AACrB;;AAEA;AACA;AACA;AACA;AACO,SAASQ,qBAAqBA,CAACC,MAAM,EAAE;EAC5C,MAAMC,cAAc,GAAG,IAAAC,kBAAW,EAACC,IAAA,IAAc;IAAA,IAAb;MAAEC;IAAK,CAAC,GAAAD,IAAA;IAC1C,MAAM;MACJb,IAAI;MACJe;IACF,CAAC,GAAGD,IAAI;IACR,IAAIJ,MAAM,CAACV,IAAI,CAAC,EAAE;MAChBU,MAAM,CAACV,IAAI,CAAC,CAACe,OAAO,CAAC;IACvB;EACF,CAAC,EAAE,CAACL,MAAM,CAAC,CAAC;EACZX,gBAAgB,CAAC,SAAS,EAAEY,cAAc,CAAC;AAC7C;;AAEA;AACA;AACA;AACA;AACA;AACO,SAASK,eAAeA,CAAA,EAAwB;EAAA,IAAvBC,cAAc,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,IAAI;EACnD,MAAM,CAACG,YAAY,EAAEC,eAAe,CAAC,GAAG,IAAAC,eAAQ,EAAC,IAAI,CAAC;EACtD,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAG,IAAAF,eAAQ,EAAC,KAAK,CAAC;EACjD,MAAMG,oBAAoB,GAAG,IAAAd,kBAAW,EAACe,KAAA,IAAgB;IAAA,IAAf;MAAEC;IAAO,CAAC,GAAAD,KAAA;IAClDL,eAAe,CAACM,MAAM,CAAC;IACvB,IAAI,CAACJ,SAAS,IAAI,CAACH,YAAY,IAAIO,MAAM,GAAG,CAAC,EAAE;MAC7CH,YAAY,CAAC,IAAI,CAAC;MAClB,IAAIR,cAAc,EAAE;QAClBA,cAAc,CAAC,CAAC;MAClB;IACF;EACF,CAAC,EAAE,CAACK,eAAe,EAAEE,SAAS,EAAEH,YAAY,EAAEI,YAAY,EAAER,cAAc,CAAC,CAAC;EAC5ER,qBAAqB,CAAC;IAAE,eAAe,EAAEiB;EAAqB,CAAC,CAAC;EAChE,OAAO,CAACF,SAAS,EAAEH,YAAY,CAAC;AAClC"}