{"version":3,"file":"thunks.js","names":["_logging","require","_api","_modelStore","addBookmark","unitId","dispatch","updateModel","modelType","model","id","bookmarked","bookmarkedUpdateState","createBookmark","error","logError","removeBookmark","deleteBookmark"],"sources":["../../../../../src/courseware/course/bookmark/data/thunks.js"],"sourcesContent":["import { logError } from '@edx/frontend-platform/logging';\nimport {\n  createBookmark,\n  deleteBookmark,\n} from './api';\nimport { updateModel } from '../../../../generic/model-store';\n\nexport function addBookmark(unitId) {\n  return async (dispatch) => {\n    // Optimistically update the bookmarked flag.\n    dispatch(updateModel({\n      modelType: 'units',\n      model: {\n        id: unitId,\n        bookmarked: true,\n        bookmarkedUpdateState: 'loading',\n      },\n    }));\n\n    try {\n      await createBookmark(unitId);\n      dispatch(updateModel({\n        modelType: 'units',\n        model: {\n          id: unitId,\n          bookmarked: true,\n          bookmarkedUpdateState: 'loaded',\n        },\n      }));\n    } catch (error) {\n      logError(error);\n      dispatch(updateModel({\n        modelType: 'units',\n        model: {\n          id: unitId,\n          bookmarked: false,\n          bookmarkedUpdateState: 'failed',\n        },\n      }));\n    }\n  };\n}\n\nexport function removeBookmark(unitId) {\n  return async (dispatch) => {\n    // Optimistically update the bookmarked flag.\n    dispatch(updateModel({\n      modelType: 'units',\n      model: {\n        id: unitId,\n        bookmarked: false,\n        bookmarkedUpdateState: 'loading',\n      },\n    }));\n    try {\n      await deleteBookmark(unitId);\n      dispatch(updateModel({\n        modelType: 'units',\n        model: {\n          id: unitId,\n          bookmarked: false,\n          bookmarkedUpdateState: 'loaded',\n        },\n      }));\n    } catch (error) {\n      logError(error);\n      dispatch(updateModel({\n        modelType: 'units',\n        model: {\n          id: unitId,\n          bookmarked: true,\n          bookmarkedUpdateState: 'failed',\n        },\n      }));\n    }\n  };\n}\n"],"mappings":";;;;;;;AAAA,IAAAA,QAAA,GAAAC,OAAA;AACA,IAAAC,IAAA,GAAAD,OAAA;AAIA,IAAAE,WAAA,GAAAF,OAAA;AAEO,SAASG,WAAWA,CAACC,MAAM,EAAE;EAClC,OAAO,MAAOC,QAAQ,IAAK;IACzB;IACAA,QAAQ,CAAC,IAAAC,uBAAW,EAAC;MACnBC,SAAS,EAAE,OAAO;MAClBC,KAAK,EAAE;QACLC,EAAE,EAAEL,MAAM;QACVM,UAAU,EAAE,IAAI;QAChBC,qBAAqB,EAAE;MACzB;IACF,CAAC,CAAC,CAAC;IAEH,IAAI;MACF,MAAM,IAAAC,mBAAc,EAACR,MAAM,CAAC;MAC5BC,QAAQ,CAAC,IAAAC,uBAAW,EAAC;QACnBC,SAAS,EAAE,OAAO;QAClBC,KAAK,EAAE;UACLC,EAAE,EAAEL,MAAM;UACVM,UAAU,EAAE,IAAI;UAChBC,qBAAqB,EAAE;QACzB;MACF,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,OAAOE,KAAK,EAAE;MACd,IAAAC,iBAAQ,EAACD,KAAK,CAAC;MACfR,QAAQ,CAAC,IAAAC,uBAAW,EAAC;QACnBC,SAAS,EAAE,OAAO;QAClBC,KAAK,EAAE;UACLC,EAAE,EAAEL,MAAM;UACVM,UAAU,EAAE,KAAK;UACjBC,qBAAqB,EAAE;QACzB;MACF,CAAC,CAAC,CAAC;IACL;EACF,CAAC;AACH;AAEO,SAASI,cAAcA,CAACX,MAAM,EAAE;EACrC,OAAO,MAAOC,QAAQ,IAAK;IACzB;IACAA,QAAQ,CAAC,IAAAC,uBAAW,EAAC;MACnBC,SAAS,EAAE,OAAO;MAClBC,KAAK,EAAE;QACLC,EAAE,EAAEL,MAAM;QACVM,UAAU,EAAE,KAAK;QACjBC,qBAAqB,EAAE;MACzB;IACF,CAAC,CAAC,CAAC;IACH,IAAI;MACF,MAAM,IAAAK,mBAAc,EAACZ,MAAM,CAAC;MAC5BC,QAAQ,CAAC,IAAAC,uBAAW,EAAC;QACnBC,SAAS,EAAE,OAAO;QAClBC,KAAK,EAAE;UACLC,EAAE,EAAEL,MAAM;UACVM,UAAU,EAAE,KAAK;UACjBC,qBAAqB,EAAE;QACzB;MACF,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,OAAOE,KAAK,EAAE;MACd,IAAAC,iBAAQ,EAACD,KAAK,CAAC;MACfR,QAAQ,CAAC,IAAAC,uBAAW,EAAC;QACnBC,SAAS,EAAE,OAAO;QAClBC,KAAK,EAAE;UACLC,EAAE,EAAEL,MAAM;UACVM,UAAU,EAAE,IAAI;UAChBC,qBAAqB,EAAE;QACzB;MACF,CAAC,CAAC,CAAC;IACL;EACF,CAAC;AACH"}