{"version":3,"file":"CourseBreadcrumbs.js","names":["_react","_interopRequireWildcard","require","_propTypes","_interopRequireDefault","_frontendPlatform","_i18n","_reactFontawesome","_faHome","_reactRedux","_paragon","_reactRouterDom","_modelStore","_JumpNavMenuItem","_jsxRuntime","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","CourseBreadcrumb","_ref","content","withSeparator","courseId","sequenceId","unitId","isStaff","defaultContent","filter","destination","id","label","sequences","showRegularLink","getConfig","ENABLE_JUMPNAV","length","isOpen","open","close","useToggle","target","setTarget","useState","jsxs","Fragment","children","jsx","className","role","style","overflow","textOverflow","whiteSpace","Link","to","onClick","ref","ModalPopup","positionRef","onClose","Menu","map","item","isDefault","title","currentSequence","currentUnit","propTypes","PropTypes","arrayOf","shape","bool","string","isRequired","defaultProps","CourseBreadcrumbs","_ref2","sectionId","course","useModel","courseStatus","useSelector","state","courseware","sequenceStatus","allSequencesInSections","fromEntries","useModels","sectionIds","section","sequenceIds","links","useMemo","chapters","sequentials","entries","forEach","_ref3","push","sequence","replace","FontAwesomeIcon","icon","faHome","FormattedMessage","description","defaultMessage","_default","exports"],"sources":["../../../src/courseware/course/CourseBreadcrumbs.jsx"],"sourcesContent":["import React, { useMemo, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { getConfig } from '@edx/frontend-platform';\nimport { FormattedMessage } from '@edx/frontend-platform/i18n';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faHome } from '@fortawesome/free-solid-svg-icons';\nimport { useSelector } from 'react-redux';\nimport { useToggle, ModalPopup, Menu } from '@edx/paragon';\nimport { Link } from 'react-router-dom';\nimport { useModel, useModels } from '../../generic/model-store';\nimport JumpNavMenuItem from './JumpNavMenuItem';\n\nconst CourseBreadcrumb = ({\n  content,\n  withSeparator,\n  courseId,\n  sequenceId,\n  unitId,\n  isStaff,\n}) => {\n  const defaultContent = content.filter(\n    (destination) => destination.default,\n  )[0] || { id: courseId, label: '', sequences: [] };\n\n  const showRegularLink = getConfig().ENABLE_JUMPNAV !== 'true' || content.length < 2 || !isStaff;\n  const [isOpen, open, close] = useToggle(false);\n  const [target, setTarget] = useState(null);\n  return (\n    <>\n      {withSeparator && (\n        <li className=\"col-auto p-0 mx-2 text-primary-500 text-truncate text-nowrap\" role=\"presentation\" aria-hidden>/</li>\n      )}\n\n      <li\n        style={{\n          overflow: 'hidden',\n          textOverflow: 'ellipsis',\n          whiteSpace: 'nowrap',\n        }}\n        data-testid=\"breadcrumb-item\"\n      >\n        {showRegularLink ? (\n          <Link\n            className=\"text-primary-500\"\n            to={\n              defaultContent.sequences.length\n                ? `/course/${courseId}/${defaultContent.sequences[0].id}`\n                : `/course/${courseId}/${defaultContent.id}`\n            }\n          >\n            {defaultContent.label}\n          </Link>\n        ) : (\n          <>\n            {\n              // eslint-disable-next-line\n              <a className=\"text-primary-500\" onClick={open} ref={setTarget}>\n                {defaultContent.label}\n              </a>\n            }\n            <ModalPopup positionRef={target} isOpen={isOpen} onClose={close}>\n              <Menu>\n                {content.map((item) => (\n                  <JumpNavMenuItem\n                    isDefault={item.default}\n                    sequences={item.sequences}\n                    courseId={courseId}\n                    title={item.label}\n                    currentSequence={sequenceId}\n                    currentUnit={unitId}\n                    onClick={close}\n                  />\n                ))}\n              </Menu>\n            </ModalPopup>\n          </>\n        )}\n      </li>\n    </>\n  );\n};\nCourseBreadcrumb.propTypes = {\n  content: PropTypes.arrayOf(\n    PropTypes.shape({\n      default: PropTypes.bool,\n      id: PropTypes.string,\n      label: PropTypes.string,\n    }),\n  ).isRequired,\n  sequenceId: PropTypes.string,\n  unitId: PropTypes.string,\n  withSeparator: PropTypes.bool,\n  courseId: PropTypes.string,\n  isStaff: PropTypes.bool,\n};\n\nCourseBreadcrumb.defaultProps = {\n  withSeparator: false,\n  sequenceId: null,\n  unitId: null,\n  courseId: null,\n  isStaff: null,\n};\n\nconst CourseBreadcrumbs = ({\n  courseId,\n  sectionId,\n  sequenceId,\n  unitId,\n  isStaff,\n}) => {\n  const course = useModel('coursewareMeta', courseId);\n  const courseStatus = useSelector((state) => state.courseware.courseStatus);\n  const sequenceStatus = useSelector(\n    (state) => state.courseware.sequenceStatus,\n  );\n\n  const allSequencesInSections = Object.fromEntries(\n    useModels('sections', course.sectionIds).map((section) => [\n      section.id,\n      {\n        default: section.id === sectionId,\n        title: section.title,\n        sequences: useModels('sequences', section.sequenceIds),\n      },\n    ]),\n  );\n\n  const links = useMemo(() => {\n    const chapters = [];\n    const sequentials = [];\n    if (courseStatus === 'loaded' && sequenceStatus === 'loaded') {\n      Object.entries(allSequencesInSections).forEach(([id, section]) => {\n        chapters.push({\n          id,\n          label: section.title,\n          default: section.default,\n          sequences: section.sequences,\n        });\n        if (section.default) {\n          section.sequences.forEach((sequence) => {\n            sequentials.push({\n              id: sequence.id,\n              label: sequence.title,\n              default: sequence.id === sequenceId,\n              sequences: [sequence],\n            });\n          });\n        }\n      });\n    }\n    return [chapters, sequentials];\n  }, [courseStatus, sequenceStatus, allSequencesInSections]);\n\n  return (\n    <nav aria-label=\"breadcrumb\" className=\"my-4 d-inline-block col-sm-10\">\n      <ol className=\"list-unstyled d-flex flex-nowrap align-items-center m-0\">\n        <li className=\"list-unstyled col-auto m-0 p-0\">\n          <Link\n            className=\"flex-shrink-0 text-primary\"\n            to={`/course/${courseId}/home`}\n            replace\n          >\n            <FontAwesomeIcon icon={faHome} className=\"mr-2\" />\n            <FormattedMessage\n              id=\"learn.breadcrumb.navigation.course.home\"\n              description=\"The course home link in breadcrumbs nav\"\n              defaultMessage=\"Course\"\n            />\n          </Link>\n        </li>\n        {links.map((content) => (\n          <CourseBreadcrumb\n            courseId={courseId}\n            sequenceId={sequenceId}\n            content={content}\n            unitId={unitId}\n            withSeparator\n            isStaff={isStaff}\n          />\n        ))}\n      </ol>\n    </nav>\n  );\n};\n\nCourseBreadcrumbs.propTypes = {\n  courseId: PropTypes.string.isRequired,\n  sectionId: PropTypes.string,\n  sequenceId: PropTypes.string,\n  unitId: PropTypes.string,\n  isStaff: PropTypes.bool,\n};\n\nCourseBreadcrumbs.defaultProps = {\n  sectionId: null,\n  sequenceId: null,\n  unitId: null,\n  isStaff: null,\n};\n\nexport default CourseBreadcrumbs;\n"],"mappings":"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"}