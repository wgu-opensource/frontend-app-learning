{"version":3,"file":"ContentIFrame.js","names":["_propTypes","_interopRequireDefault","require","_react","_react2","_reactUnitTestUtils","_paragon","_PageLoading","hooks","_interopRequireWildcard","_jsxRuntime","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","value","_toPropertyKey","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","TypeError","Number","IFRAME_FEATURE_POLICY","exports","testIDs","StrictDict","contentIFrame","modalIFrame","ContentIFrame","_ref","iframeUrl","shouldShowContent","loadingMessage","id","elementId","onLoaded","title","handleIFrameLoad","hasLoaded","iframeHeight","showError","useIFrameBehavior","modalOptions","handleModalClose","useModalIFrameData","contentIFrameProps","src","allow","allowFullScreen","height","scrolling","referrerPolicy","onLoad","jsxs","Fragment","children","jsx","ErrorPage","srMessage","className","isOpen","Modal","body","frameBorder","url","style","width","dialogClassName","onClose","open","propTypes","PropTypes","string","isRequired","bool","node","func","defaultProps","_default"],"sources":["../../../../../src/courseware/course/sequence/Unit/ContentIFrame.jsx"],"sourcesContent":["import PropTypes from 'prop-types';\nimport React from 'react';\n\nimport { ErrorPage } from '@edx/frontend-platform/react';\nimport { StrictDict } from '@edx/react-unit-test-utils';\nimport { Modal } from '@edx/paragon';\n\nimport PageLoading from '../../../../generic/PageLoading';\nimport * as hooks from './hooks';\n\n/**\n * Feature policy for iframe, allowing access to certain courseware-related media.\n *\n * We must use the wildcard (*) origin for each feature, as courseware content\n * may be embedded in external iframes. Notably, xblock-lti-consumer is a popular\n * block that iframes external course content.\n\n * This policy was selected in conference with the edX Security Working Group.\n * Changes to it should be vetted by them (security@edx.org).\n */\nexport const IFRAME_FEATURE_POLICY = (\n  'microphone *; camera *; midi *; geolocation *; encrypted-media *, clipboard-write *'\n);\n\nexport const testIDs = StrictDict({\n  contentIFrame: 'content-iframe-test-id',\n  modalIFrame: 'modal-iframe-test-id',\n});\n\nconst ContentIFrame = ({\n  iframeUrl,\n  shouldShowContent,\n  loadingMessage,\n  id,\n  elementId,\n  onLoaded,\n  title,\n}) => {\n  const {\n    handleIFrameLoad,\n    hasLoaded,\n    iframeHeight,\n    showError,\n  } = hooks.useIFrameBehavior({\n    elementId,\n    id,\n    iframeUrl,\n    onLoaded,\n  });\n\n  const {\n    modalOptions,\n    handleModalClose,\n  } = hooks.useModalIFrameData();\n\n  const contentIFrameProps = {\n    id: elementId,\n    src: iframeUrl,\n    allow: IFRAME_FEATURE_POLICY,\n    allowFullScreen: true,\n    height: iframeHeight,\n    scrolling: 'no',\n    referrerPolicy: 'origin',\n    onLoad: handleIFrameLoad,\n  };\n\n  return (\n    <>\n      {(shouldShowContent && !hasLoaded) && (\n        showError ? <ErrorPage /> : <PageLoading srMessage={loadingMessage} />\n      )}\n      {shouldShowContent && (\n        <div className=\"unit-iframe-wrapper\">\n          <iframe title={title} {...contentIFrameProps} data-testid={testIDs.contentIFrame} />\n        </div>\n      )}\n      {modalOptions.isOpen && (\n        <Modal\n          body={modalOptions.body\n            ? <div className=\"unit-modal\">{ modalOptions.body }</div>\n            : (\n              <iframe\n                title={modalOptions.title}\n                allow={IFRAME_FEATURE_POLICY}\n                frameBorder=\"0\"\n                src={modalOptions.url}\n                style={{ width: '100%', height: modalOptions.height }}\n              />\n            )}\n          dialogClassName=\"modal-lti\"\n          onClose={handleModalClose}\n          open\n        />\n      )}\n    </>\n  );\n};\n\nContentIFrame.propTypes = {\n  iframeUrl: PropTypes.string,\n  id: PropTypes.string.isRequired,\n  shouldShowContent: PropTypes.bool.isRequired,\n  loadingMessage: PropTypes.node.isRequired,\n  elementId: PropTypes.string.isRequired,\n  onLoaded: PropTypes.func,\n  title: PropTypes.node.isRequired,\n};\n\nContentIFrame.defaultProps = {\n  iframeUrl: null,\n  onLoaded: () => ({}),\n};\n\nexport default ContentIFrame;\n"],"mappings":"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"}