{"version":3,"file":"Unit.js","names":["_frontendPlatform","require","_i18n","_react","_paragon","_propTypes","_interopRequireDefault","_react2","_interopRequireWildcard","_reactRedux","_thunks","_hooks","_modelStore","_PageLoading","_data","_BookmarkButton","_ShareButton","_messages","_jsxRuntime","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","HonorCode","React","lazy","Promise","resolve","then","LockPaywall","IFRAME_FEATURE_POLICY","useLoadBearingHook","id","setValue","useState","useLayoutEffect","currentValue","sendUrlHashToFrame","frame","hash","window","location","contentWindow","postMessage","hashName","getConfig","LMS_BASE_URL","Unit","_ref","courseId","format","onLoaded","intl","authenticatedUser","useContext","AppContext","view","iframeUrl","iframeHeight","setIframeHeight","hasLoaded","setHasLoaded","showError","setShowError","modalOptions","setModalOptions","open","shouldDisplayHonorCode","setShouldDisplayHonorCode","windowTopOffset","setWindowTopOffset","unit","useModel","course","contentTypeGatingEnabled","userNeedsIntegritySignature","dispatch","useDispatch","useEffect","graded","receiveMessage","useCallback","_ref2","data","type","payload","height","scrollTo","Number","scrollY","offset","document","getElementById","offsetTop","useEventListener","jsxs","className","children","jsx","title","formatMessage","messages","headerPlaceholder","unitId","isBookmarked","bookmarked","isProcessing","bookmarkedUpdateState","expSocialShareAboutUrls","undefined","url","containsContentTypeGatedContent","Suspense","fallback","srMessage","loadingLockedContent","loadingHonorCode","loadingSequence","ErrorPage","Modal","body","Fragment","allow","frameBorder","src","style","width","onClose","dialogClassName","allowFullScreen","scrolling","referrerPolicy","onLoad","onmessage","e","event_name","processEvent","fetchCourse","propTypes","PropTypes","string","isRequired","intlShape","func","defaultProps","_default","injectIntl","exports"],"sources":["../../../../src/courseware/course/sequence/Unit.jsx"],"sourcesContent":["import { getConfig } from '@edx/frontend-platform';\nimport { injectIntl, intlShape } from '@edx/frontend-platform/i18n';\nimport { AppContext, ErrorPage } from '@edx/frontend-platform/react';\nimport { Modal } from '@edx/paragon';\nimport PropTypes from 'prop-types';\nimport React, {\n  Suspense, useCallback, useContext, useEffect, useLayoutEffect, useState,\n} from 'react';\nimport { useDispatch } from 'react-redux';\nimport { processEvent } from '../../../course-home/data/thunks';\nimport { useEventListener } from '../../../generic/hooks';\nimport { useModel } from '../../../generic/model-store';\nimport PageLoading from '../../../generic/PageLoading';\nimport { fetchCourse } from '../../data';\nimport BookmarkButton from '../bookmark/BookmarkButton';\nimport ShareButton from '../share/ShareButton';\nimport messages from './messages';\n\nconst HonorCode = React.lazy(() => import('./honor-code'));\nconst LockPaywall = React.lazy(() => import('./lock-paywall'));\n\n/**\n * Feature policy for iframe, allowing access to certain courseware-related media.\n *\n * We must use the wildcard (*) origin for each feature, as courseware content\n * may be embedded in external iframes. Notably, xblock-lti-consumer is a popular\n * block that iframes external course content.\n\n * This policy was selected in conference with the edX Security Working Group.\n * Changes to it should be vetted by them (security@edx.org).\n */\nconst IFRAME_FEATURE_POLICY = (\n  'microphone *; camera *; midi *; geolocation *; encrypted-media *'\n);\n\n/**\n * We discovered an error in Firefox where - upon iframe load - React would cease to call any\n * useEffect hooks until the user interacts with the page again.  This is particularly confusing\n * when navigating between sequences, as the UI partially updates leaving the user in a nebulous\n * state.\n *\n * We were able to solve this error by using a layout effect to update some component state, which\n * executes synchronously on render.  Somehow this forces React to continue it's lifecycle\n * immediately, rather than waiting for user interaction.  This layout effect could be anywhere in\n * the parent tree, as far as we can tell - we chose to add a conspicuously 'load bearing' (that's\n * a joke) one here so it wouldn't be accidentally removed elsewhere.\n *\n * If we remove this hook when one of these happens:\n * 1. React figures out that there's an issue here and fixes a bug.\n * 2. We cease to use an iframe for unit rendering.\n * 3. Firefox figures out that there's an issue in their iframe loading and fixes a bug.\n * 4. We stop supporting Firefox.\n * 5. An enterprising engineer decides to create a repo that reproduces the problem, submits it to\n *    Firefox/React for review, and they kindly help us figure out what in the world is happening\n *    so  we can fix it.\n *\n * This hook depends on the unit id just to make sure it re-evaluates whenever the ID changes.  If\n * we change whether or not the Unit component is re-mounted when the unit ID changes, this may\n * become important, as this hook will otherwise only evaluate the useLayoutEffect once.\n */\nfunction useLoadBearingHook(id) {\n  const setValue = useState(0)[1];\n  useLayoutEffect(() => {\n    setValue(currentValue => currentValue + 1);\n  }, [id]);\n}\n\nexport function sendUrlHashToFrame(frame) {\n  const { hash } = window.location;\n  if (hash) {\n    // The url hash will be sent to LMS-served iframe in order to find the location of the\n    // hash within the iframe.\n    frame.contentWindow.postMessage({ hashName: hash }, `${getConfig().LMS_BASE_URL}`);\n  }\n}\n\nconst Unit = ({\n  courseId,\n  format,\n  onLoaded,\n  id,\n  intl,\n}) => {\n  const { authenticatedUser } = useContext(AppContext);\n  const view = authenticatedUser ? 'student_view' : 'public_view';\n  let iframeUrl = `${getConfig().LMS_BASE_URL}/xblock/${id}?show_title=0&show_bookmark_button=0&recheck_access=1&view=${view}`;\n  if (format) {\n    iframeUrl += `&format=${format}`;\n  }\n\n  const [iframeHeight, setIframeHeight] = useState(0);\n  const [hasLoaded, setHasLoaded] = useState(false);\n  const [showError, setShowError] = useState(false);\n  const [modalOptions, setModalOptions] = useState({ open: false });\n  const [shouldDisplayHonorCode, setShouldDisplayHonorCode] = useState(false);\n  const [windowTopOffset, setWindowTopOffset] = useState(null);\n\n  const unit = useModel('units', id);\n  const course = useModel('coursewareMeta', courseId);\n  const {\n    contentTypeGatingEnabled,\n    userNeedsIntegritySignature,\n  } = course;\n\n  const dispatch = useDispatch();\n  // Do not remove this hook.  See function description.\n  useLoadBearingHook(id);\n\n  useEffect(() => {\n    if (userNeedsIntegritySignature && unit.graded) {\n      setShouldDisplayHonorCode(true);\n    } else {\n      setShouldDisplayHonorCode(false);\n    }\n  }, [userNeedsIntegritySignature]);\n\n  const receiveMessage = useCallback(({ data }) => {\n    const {\n      type,\n      payload,\n    } = data;\n    if (type === 'plugin.resize') {\n      setIframeHeight(payload.height);\n\n      // We observe exit from the video xblock full screen mode\n      // and do page scroll to the previously saved scroll position\n      if (windowTopOffset !== null) {\n        window.scrollTo(0, Number(windowTopOffset));\n      }\n\n      if (!hasLoaded && iframeHeight === 0 && payload.height > 0) {\n        setHasLoaded(true);\n        if (onLoaded) {\n          onLoaded();\n        }\n      }\n    } else if (type === 'plugin.modal') {\n      payload.open = true;\n      setModalOptions(payload);\n    } else if (type === 'plugin.videoFullScreen') {\n      // We listen for this message from LMS to know when we need to\n      // save or reset scroll position on toggle video xblock full screen mode.\n      setWindowTopOffset(payload.open ? window.scrollY : null);\n    } else if (data.offset) {\n      // We listen for this message from LMS to know when the page needs to\n      // be scrolled to another location on the page.\n      window.scrollTo(0, data.offset + document.getElementById('unit-iframe').offsetTop);\n    }\n  }, [id, setIframeHeight, hasLoaded, iframeHeight, setHasLoaded, onLoaded, setWindowTopOffset, windowTopOffset]);\n  useEventListener('message', receiveMessage);\n  useEffect(() => {\n    sendUrlHashToFrame(document.getElementById('unit-iframe'));\n  }, [id, setIframeHeight, hasLoaded, iframeHeight, setHasLoaded, onLoaded]);\n\n  return (\n    <div className=\"unit\">\n      <h1 className=\"mb-0 h3\">{unit.title}</h1>\n      <h2 className=\"sr-only\">{intl.formatMessage(messages.headerPlaceholder)}</h2>\n      <BookmarkButton\n        unitId={unit.id}\n        isBookmarked={unit.bookmarked}\n        isProcessing={unit.bookmarkedUpdateState === 'loading'}\n      />\n      {/* TODO: social share exp. Need to remove later */}\n      {(window.expSocialShareAboutUrls && window.expSocialShareAboutUrls[unit.id] !== undefined) && (\n        <ShareButton url={window.expSocialShareAboutUrls[unit.id]} />\n      )}\n      {contentTypeGatingEnabled && unit.containsContentTypeGatedContent && (\n        <Suspense\n          fallback={(\n            <PageLoading\n              srMessage={intl.formatMessage(messages.loadingLockedContent)}\n            />\n          )}\n        >\n          <LockPaywall courseId={courseId} />\n        </Suspense>\n      )}\n      {shouldDisplayHonorCode && (\n        <Suspense\n          fallback={(\n            <PageLoading\n              srMessage={intl.formatMessage(messages.loadingHonorCode)}\n            />\n          )}\n        >\n          <HonorCode courseId={courseId} />\n        </Suspense>\n      )}\n      {!shouldDisplayHonorCode && !hasLoaded && !showError && (\n        <PageLoading\n          srMessage={intl.formatMessage(messages.loadingSequence)}\n        />\n      )}\n      {!shouldDisplayHonorCode && !hasLoaded && showError && (\n        <ErrorPage />\n      )}\n      {modalOptions.open && (\n        <Modal\n          body={(\n            <>\n              {modalOptions.body\n                ? <div className=\"unit-modal\">{ modalOptions.body }</div>\n                : (\n                  <iframe\n                    title={modalOptions.title}\n                    allow={IFRAME_FEATURE_POLICY}\n                    frameBorder=\"0\"\n                    src={modalOptions.url}\n                    style={{\n                      width: '100%',\n                      height: '100vh',\n                    }}\n                  />\n                )}\n            </>\n          )}\n          onClose={() => { setModalOptions({ open: false }); }}\n          open\n          dialogClassName=\"modal-lti\"\n        />\n      )}\n      {!shouldDisplayHonorCode && (\n        <div className=\"unit-iframe-wrapper\">\n          <iframe\n            id=\"unit-iframe\"\n            title={unit.title}\n            src={iframeUrl}\n            allow={IFRAME_FEATURE_POLICY}\n            allowFullScreen\n            height={iframeHeight}\n            scrolling=\"no\"\n            referrerPolicy=\"origin\"\n            onLoad={() => {\n              // onLoad *should* only fire after everything in the iframe has finished its own load events.\n              // Which means that the plugin.resize message (which calls setHasLoaded above) will have fired already\n              // for a successful load. If it *has not fired*, we are in an error state. For example, the backend\n              // could have given us a 4xx or 5xx response.\n              if (!hasLoaded) {\n                setShowError(true);\n              }\n\n              window.onmessage = (e) => {\n                if (e.data.event_name) {\n                  dispatch(processEvent(e.data, fetchCourse));\n                }\n              };\n            }}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n\nUnit.propTypes = {\n  courseId: PropTypes.string.isRequired,\n  format: PropTypes.string,\n  id: PropTypes.string.isRequired,\n  intl: intlShape.isRequired,\n  onLoaded: PropTypes.func,\n};\n\nUnit.defaultProps = {\n  format: null,\n  onLoaded: undefined,\n};\n\nexport default injectIntl(Unit);\n"],"mappings":"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"}