{"version":3,"sources":["../../../src/shared/streak-celebration/StreakCelebrationModal.jsx"],"names":["getRandomFactoid","intl","streakLength","boldedSectionA","formatMessage","messages","streakFactoidABoldedSection","boldedSectionB","streakFactoidBBoldedSection","factoids","bolded_section","streak_length","Math","floor","random","length","calculateVoucherDiscount","voucher","sku","username","urlBase","ECOMMERCE_BASE_URL","url","get","then","res","StreakModal","courseId","metadataModel","streakLengthToCelebrate","isStreakCelebrationOpen","closeStreakCelebration","streakDiscountCouponEnabled","verifiedMode","rest","org","celebrations","factoid","randomFactoid","setRandomFactoid","discountCode","discountPercent","setDiscountPercent","queryingDiscount","wideScreen","width","breakpoints","small","minWidth","dispatch","result","totalInclTax","totalInclTaxExclDiscounts","data","course_id","CloseText","streakButton","streakButtonSrOnly","upgradeUrl","mode","offer","currencySymbol","price","discountMultipler","discountedPrice","toFixed","toString","originalPrice","title","streakHeader","showOffer","streakBody","StreakMobileImage","StreakDesktopImage","Lightbulb","MoneyFilled","congratulations","streakDiscountMessage","percent","date","Date","now","toLocaleDateString","timeZone","streakButtonAA759","defaultProps","propTypes","PropTypes","string","isRequired","number","intlShape","bool","func","shape"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { camelCaseObject, getConfig } from '@edx/frontend-platform';\nimport { sendTrackEvent } from '@edx/frontend-platform/analytics';\nimport { getAuthenticatedHttpClient } from '@edx/frontend-platform/auth';\nimport {\n  FormattedMessage, injectIntl, intlShape,\n} from '@edx/frontend-platform/i18n';\nimport { Lightbulb, MoneyFilled } from '@edx/paragon/icons';\nimport {\n  Alert, breakpoints, Icon, ModalDialog, Spinner, useWindowSize,\n} from '@edx/paragon';\nimport { useDispatch } from 'react-redux';\nimport { UpgradeNowButton } from '../../generic/upgrade-button';\n\nimport { useModel } from '../../generic/model-store';\nimport StreakMobileImage from './assets/Streak_mobile.png';\nimport StreakDesktopImage from './assets/Streak_desktop.png';\nimport messages from './messages';\nimport { recordModalClosing, recordStreakCelebration } from './utils';\n\nfunction getRandomFactoid(intl, streakLength) {\n  const boldedSectionA = intl.formatMessage(messages.streakFactoidABoldedSection);\n  const boldedSectionB = intl.formatMessage(messages.streakFactoidBBoldedSection);\n  const factoids = [\n    (<FormattedMessage\n      id=\"learning.streakcelebration.factoida\"\n      defaultMessage=\"Users who learn {streak_length} days in a row {bolded_section} than those who don’t.\"\n      values={{\n        bolded_section: (<b>{boldedSectionA}</b>),\n        streak_length: (streakLength),\n      }}\n    />),\n    (<FormattedMessage\n      id=\"learning.streakcelebration.factoidb\"\n      defaultMessage=\"Users who learn {streak_length} days in a row {bolded_section} vs. those who don’t.\"\n      values={{\n        bolded_section: (<b>{boldedSectionB}</b>),\n        streak_length: (streakLength),\n      }}\n    />),\n  ];\n  return factoids[Math.floor(Math.random() * (factoids.length))];\n}\n\nasync function calculateVoucherDiscount(voucher, sku, username) {\n  const urlBase = `${getConfig().ECOMMERCE_BASE_URL}/api/v2/baskets/calculate`;\n  const url = `${urlBase}/?code=${voucher}&sku=${sku}&username=${username}`;\n  return getAuthenticatedHttpClient().get(url)\n    .then(res => camelCaseObject(res));\n}\n\nfunction StreakModal({\n  courseId, metadataModel, streakLengthToCelebrate, intl, isStreakCelebrationOpen,\n  closeStreakCelebration, streakDiscountCouponEnabled, verifiedMode, ...rest\n}) {\n  if (!isStreakCelebrationOpen) {\n    return null;\n  }\n  const { org, celebrations, username } = useModel('courseHomeMeta', courseId);\n  const factoid = getRandomFactoid(intl, streakLengthToCelebrate);\n  // eslint-disable-next-line no-unused-vars\n  const [randomFactoid, setRandomFactoid] = useState(factoid); // Don't change factoid on re-render\n\n  // Open edX Folks: if you create a voucher with this code, the MFE will notice and show the discount\n  const discountCode = 'ZGY11119949';\n  // Negative means \"we don't know yet\" vs zero meaning no discount available\n  const [discountPercent, setDiscountPercent] = useState(-1);\n  const queryingDiscount = discountPercent < 0;\n\n  const wideScreen = useWindowSize().width >= breakpoints.small.minWidth;\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    if (isStreakCelebrationOpen) {\n      recordStreakCelebration(org, courseId);\n    }\n  }, [isStreakCelebrationOpen, org, courseId]);\n\n  // Ask ecommerce to calculate discount savings\n  useEffect(() => {\n    if (streakDiscountCouponEnabled && verifiedMode && getConfig().ECOMMERCE_BASE_URL) {\n      calculateVoucherDiscount(discountCode, verifiedMode.sku, username)\n        .then(\n          (result) => {\n            const { totalInclTax, totalInclTaxExclDiscounts } = result.data;\n            if (totalInclTaxExclDiscounts && totalInclTax !== totalInclTaxExclDiscounts) {\n              // Just store the percent (rather than using these values directly), because ecommerce doesn't give us\n              // the currency symbol to use, so we want to use the symbol that LMS gives us. And I don't want to assume\n              // ecommerce's currency is the same as the LMS. So we'll keep using the values in verifiedMode, just\n              // multiplied by the calculated percentage.\n              setDiscountPercent(1 - totalInclTax / totalInclTaxExclDiscounts);\n              sendTrackEvent('edx.bi.course.streak_discount_enabled', {\n                course_id: courseId,\n                sku: verifiedMode.sku,\n              });\n            } else {\n              setDiscountPercent(0);\n            }\n          },\n          () => {\n            // ignore any errors - we just won't show the discount to the user then\n            setDiscountPercent(0);\n          },\n        );\n    } else {\n      setDiscountPercent(0);\n    }\n  }, [streakDiscountCouponEnabled, username, verifiedMode]);\n\n  function CloseText() {\n    return (\n      <span>\n        {intl.formatMessage(messages.streakButton)}\n        <span className=\"sr-only\">. {intl.formatMessage(messages.streakButtonSrOnly)}</span>\n      </span>\n    );\n  }\n\n  let upgradeUrl;\n  let mode;\n  let offer;\n\n  if (verifiedMode) {\n    upgradeUrl = `${verifiedMode.upgradeUrl}`;\n    mode = {\n      currencySymbol: verifiedMode.currencySymbol,\n      price: verifiedMode.price,\n      upgradeUrl,\n    };\n\n    if (discountPercent > 0) {\n      const discountMultipler = 1 - discountPercent;\n      offer = {\n        discountedPrice: `${verifiedMode.currencySymbol}${(mode.price * discountMultipler).toFixed(2).toString()}`,\n        originalPrice: `${verifiedMode.currencySymbol}${mode.price.toString()}`,\n        upgradeUrl: `${mode.upgradeUrl}&code=${discountCode}`,\n      };\n    }\n  }\n\n  const title = `${streakLengthToCelebrate} ${intl.formatMessage(messages.streakHeader)}`;\n  const showOffer = offer && streakDiscountCouponEnabled;\n\n  return (\n    <ModalDialog\n      className=\"streak-modal modal-dialog-centered\"\n      title={title}\n      onClose={() => {\n        closeStreakCelebration();\n        recordModalClosing(celebrations, org, courseId, dispatch);\n      }}\n      isOpen={isStreakCelebrationOpen}\n      isFullscreenScroll\n      {...rest}\n    >\n      <ModalDialog.Header className=\"modal-header\">\n        <ModalDialog.Title className=\"mr-0 modal-title\">\n          {title}\n        </ModalDialog.Title>\n      </ModalDialog.Header>\n      <ModalDialog.Body className=\"modal-body\">\n        <p className=\"text-center\">{intl.formatMessage(messages.streakBody)}</p>\n        <p className=\"modal-image text-center\">\n          {!wideScreen && <img src={StreakMobileImage} alt=\"\" className=\"img-fluid\" />}\n          {wideScreen && <img src={StreakDesktopImage} alt=\"\" className=\"img-fluid\" />}\n        </p>\n        { queryingDiscount && (\n          <Spinner animation=\"border\" variant=\"primary\" />\n        )}\n        { !queryingDiscount && !showOffer && (\n          <div className=\"d-flex py-3 bg-light-300\">\n            <Icon className=\"col-small ml-3\" src={Lightbulb} />\n            <div className=\"col-11 factoid-wrapper\">\n              {randomFactoid}\n            </div>\n          </div>\n        )}\n        { !queryingDiscount && showOffer && (\n          <Alert variant=\"success\" className=\"px-0\">\n            <div className=\"d-flex\">\n              <Icon className=\"col-small ml-3 text-success-500\" src={MoneyFilled} />\n              <div className=\"col-11 factoid-wrapper\">\n                <b>{intl.formatMessage(messages.congratulations)}</b>\n                &nbsp;{intl.formatMessage(messages.streakDiscountMessage, {\n                  percent: (discountPercent * 100).toFixed(0),\n                })}&nbsp;\n                <FormattedMessage\n                  id=\"learning.streakCelebration.streakCelebrationCouponEndDateMessage\"\n                  defaultMessage=\"Ends {date}.\"\n                  values={{\n                    date: new Date(Date.now() + 14 * 24 * 60 * 60 * 1000).toLocaleDateString({ timeZone: 'UTC' }),\n                  }}\n                />\n              </div>\n            </div>\n          </Alert>\n        )}\n      </ModalDialog.Body>\n      <ModalDialog.Footer className=\"modal-footer d-block\">\n        { !queryingDiscount && showOffer && (\n          <>\n            {!wideScreen && (\n              <>\n                <UpgradeNowButton\n                  className=\"upgrade mb-3\"\n                  size=\"sm\"\n                  offer={offer}\n                  variant=\"brand\"\n                  verifiedMode={mode}\n                />\n                <ModalDialog.CloseButton variant=\"outline-brand\" className=\"btn-sm\">\n                  {intl.formatMessage(messages.streakButtonAA759)}\n                </ModalDialog.CloseButton>\n              </>\n            )}\n            {wideScreen && (\n              <>\n                <UpgradeNowButton\n                  className=\"upgrade mb-3\"\n                  offer={offer}\n                  variant=\"brand\"\n                  verifiedMode={mode}\n                />\n                <ModalDialog.CloseButton variant=\"outline-brand\">\n                  {intl.formatMessage(messages.streakButtonAA759)}\n                </ModalDialog.CloseButton>\n              </>\n            )}\n          </>\n        )}\n        { !queryingDiscount && !showOffer && (\n          <ModalDialog.CloseButton className=\"px-5\" variant=\"primary\"><CloseText /></ModalDialog.CloseButton>\n        )}\n      </ModalDialog.Footer>\n    </ModalDialog>\n  );\n}\n\nStreakModal.defaultProps = {\n  isStreakCelebrationOpen: false,\n  streakDiscountCouponEnabled: false,\n  streakLengthToCelebrate: -1,\n  verifiedMode: {},\n};\n\nStreakModal.propTypes = {\n  courseId: PropTypes.string.isRequired,\n  metadataModel: PropTypes.string.isRequired,\n  streakLengthToCelebrate: PropTypes.number,\n  intl: intlShape.isRequired,\n  isStreakCelebrationOpen: PropTypes.bool,\n  closeStreakCelebration: PropTypes.func.isRequired,\n  streakDiscountCouponEnabled: PropTypes.bool,\n  verifiedMode: PropTypes.shape({\n    currencySymbol: PropTypes.string,\n    price: PropTypes.number,\n    sku: PropTypes.string,\n    upgradeUrl: PropTypes.string,\n  }),\n};\n\nexport default injectIntl(StreakModal);\n"],"file":"StreakCelebrationModal.js"}