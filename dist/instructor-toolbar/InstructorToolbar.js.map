{"version":3,"file":"InstructorToolbar.js","names":["_react","_interopRequireWildcard","require","_propTypes","_interopRequireDefault","_frontendPlatform","_userMessages","_Alert","_masqueradeWidget","_accessExpirationAlert","_courseStartAlert","_jsxRuntime","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","value","_toPropertyKey","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","TypeError","Number","getInsightsUrl","courseId","urlBase","getConfig","INSIGHTS_BASE_URL","urlFull","getStudioUrl","unitId","STUDIO_BASE_URL","InstructorToolbar","props","didMount","setDidMount","useState","useEffect","tab","urlInsights","urlStudio","masqueradeErrorMessage","showMasqueradeError","accessExpirationMasqueradeBanner","useAccessExpirationMasqueradeBanner","courseStartDateMasqueradeBanner","useCourseStartMasqueradeBanner","jsxs","children","jsx","className","onError","Fragment","href","type","ALERT_TYPES","ERROR","dismissible","AlertList","topic","customAlerts","propTypes","PropTypes","string","defaultProps","_default","exports"],"sources":["../../src/instructor-toolbar/InstructorToolbar.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { getConfig } from '@edx/frontend-platform';\n\nimport { ALERT_TYPES, AlertList } from '../generic/user-messages';\nimport Alert from '../generic/user-messages/Alert';\nimport MasqueradeWidget from './masquerade-widget';\nimport { useAccessExpirationMasqueradeBanner } from '../alerts/access-expiration-alert';\nimport { useCourseStartMasqueradeBanner } from '../alerts/course-start-alert';\n\nfunction getInsightsUrl(courseId) {\n  const urlBase = getConfig().INSIGHTS_BASE_URL;\n  let urlFull;\n  if (urlBase) {\n    urlFull = `${urlBase}/courses`;\n    // This shouldn't actually be missing, at present,\n    // but we're providing a reasonable fallback,\n    // in case of either error or extension.\n    if (courseId) {\n      urlFull += `/${courseId}`;\n    }\n  }\n  return urlFull;\n}\n\nfunction getStudioUrl(courseId, unitId) {\n  const urlBase = getConfig().STUDIO_BASE_URL;\n  let urlFull;\n  if (urlBase) {\n    if (unitId) {\n      urlFull = `${urlBase}/container/${unitId}`;\n    } else if (courseId) {\n      urlFull = `${urlBase}/course/${courseId}`;\n    }\n  }\n  return urlFull;\n}\n\nconst InstructorToolbar = (props) => {\n  // This didMount logic became necessary once we had a page that does a redirect on a quick exit.\n  // As a result, it unmounts the InstructorToolbar (which will be remounted by the new component),\n  // but the InstructorToolbar's MasqueradeWidget has an outgoing request. Since it is unmounted\n  // during that time, it raises an error about a potential memory leak. By stopping the render\n  // when the InstructorToolbar is unmounted, we avoid the memory leak.\n  // NOTE: This was originally added because of the CourseExit page redirect. Once that page stops\n  //   doing a redirect because a CourseExit experience exists for all learners, this could be removed\n  const [didMount, setDidMount] = useState(false);\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useEffect(() => {\n    setDidMount(true);\n    // Returning this function here will run setDidMount(false) when this component is unmounted\n    return () => setDidMount(false);\n  });\n\n  const {\n    courseId,\n    unitId,\n    tab,\n  } = props;\n\n  const urlInsights = getInsightsUrl(courseId);\n  const urlStudio = getStudioUrl(courseId, unitId);\n  const [masqueradeErrorMessage, showMasqueradeError] = useState(null);\n\n  const accessExpirationMasqueradeBanner = useAccessExpirationMasqueradeBanner(courseId, tab);\n  const courseStartDateMasqueradeBanner = useCourseStartMasqueradeBanner(courseId, tab);\n\n  return (!didMount ? null : (\n    <div data-testid=\"instructor-toolbar\">\n      <div className=\"bg-primary text-white\">\n        <div className=\"container-xl py-3 d-md-flex justify-content-end align-items-start\">\n          <div className=\"align-items-center flex-grow-1 d-md-flex mx-1 my-1\">\n            <MasqueradeWidget courseId={courseId} onError={showMasqueradeError} />\n          </div>\n          {(urlStudio || urlInsights) && (\n            <>\n              <hr className=\"border-light\" />\n              <span className=\"mr-2 mt-1 col-form-label\">View course in:</span>\n            </>\n          )}\n          {urlStudio && (\n            <span className=\"mx-1 my-1\">\n              <a className=\"btn btn-inverse-outline-primary\" href={urlStudio}>Studio</a>\n            </span>\n          )}\n          {urlInsights && (\n            <span className=\"mx-1 my-1\">\n              <a className=\"btn btn-inverse-outline-primary\" href={urlInsights}>Insights</a>\n            </span>\n          )}\n        </div>\n      </div>\n      {masqueradeErrorMessage && (\n        <div className=\"container-xl mt-3\">\n          <Alert\n            type={ALERT_TYPES.ERROR}\n            dismissible={false}\n          >\n            {masqueradeErrorMessage}\n          </Alert>\n        </div>\n      )}\n      <AlertList\n        topic=\"instructor-toolbar-alerts\"\n        customAlerts={{\n          ...accessExpirationMasqueradeBanner,\n          ...courseStartDateMasqueradeBanner,\n        }}\n      />\n    </div>\n  ));\n};\n\nInstructorToolbar.propTypes = {\n  courseId: PropTypes.string,\n  unitId: PropTypes.string,\n  tab: PropTypes.string,\n};\n\nInstructorToolbar.defaultProps = {\n  courseId: undefined,\n  unitId: undefined,\n  tab: '',\n};\n\nexport default InstructorToolbar;\n"],"mappings":"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"}