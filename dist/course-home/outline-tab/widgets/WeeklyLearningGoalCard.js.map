{"version":3,"file":"WeeklyLearningGoalCard.js","names":["_react","_interopRequireWildcard","require","_reactRouterDom","_propTypes","_interopRequireDefault","_paragon","_frontendPlatform","_analytics","_auth","_i18n","_icons","_reactRedux","_messages","_LearningGoalButton","_data","_modelStore","_jsxRuntime","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","WeeklyLearningGoalCard","_ref","daysPerWeek","subscribedToReminders","intl","courseId","useSelector","state","courseHome","isMasquerading","org","useModel","administrator","getAuthenticatedUser","daysPerWeekGoal","setDaysPerWeekGoal","useState","isGetReminderSelected","setGetReminderSelected","location","useLocation","handleSelect","days","triggeredFromEmail","arguments","length","undefined","selectReminders","saveWeeklyLearningGoal","sendTrackEvent","org_key","courserun_key","is_staff","num_days","reminder_selected","handleSubscribeToReminders","event","isGetReminderChecked","target","checked","useEffect","currentParams","URLSearchParams","search","weeklyGoal","Number","includes","delete","history","replace","toString","jsxs","Card","id","className","children","jsx","Header","size","title","formatMessage","messages","setWeeklyGoal","subtitle","setWeeklyGoalDetail","Section","role","level","isSelected","Form","Switch","onChange","disabled","setGoalReminder","muted","Icon","src","Email","goalReminderDetail","propTypes","PropTypes","number","bool","intlShape","isRequired","defaultProps","_default","injectIntl","exports"],"sources":["../../../../src/course-home/outline-tab/widgets/WeeklyLearningGoalCard.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport PropTypes from 'prop-types';\n\nimport { Form, Card, Icon } from '@edx/paragon';\nimport { history } from '@edx/frontend-platform';\nimport { sendTrackEvent } from '@edx/frontend-platform/analytics';\nimport { getAuthenticatedUser } from '@edx/frontend-platform/auth';\nimport { injectIntl, intlShape } from '@edx/frontend-platform/i18n';\nimport { Email } from '@edx/paragon/icons';\nimport { useSelector } from 'react-redux';\nimport messages from '../messages';\nimport LearningGoalButton from './LearningGoalButton';\nimport { saveWeeklyLearningGoal } from '../../data';\nimport { useModel } from '../../../generic/model-store';\nimport './FlagButton.scss';\n\nconst WeeklyLearningGoalCard = ({\n  daysPerWeek,\n  subscribedToReminders,\n  intl,\n}) => {\n  const {\n    courseId,\n  } = useSelector(state => state.courseHome);\n\n  const {\n    isMasquerading,\n    org,\n  } = useModel('courseHomeMeta', courseId);\n\n  const { administrator } = getAuthenticatedUser();\n\n  const [daysPerWeekGoal, setDaysPerWeekGoal] = useState(daysPerWeek);\n  // eslint-disable-next-line react/prop-types\n  const [isGetReminderSelected, setGetReminderSelected] = useState(subscribedToReminders);\n  const location = useLocation();\n\n  const handleSelect = (days, triggeredFromEmail = false) => {\n    // Set the subscription button if this is the first time selecting a goal\n    const selectReminders = daysPerWeekGoal === null ? true : isGetReminderSelected;\n    setGetReminderSelected(selectReminders);\n    setDaysPerWeekGoal(days);\n    if (!isMasquerading) { // don't save goal updates while masquerading\n      saveWeeklyLearningGoal(courseId, days, selectReminders);\n      sendTrackEvent('edx.ui.lms.goal.days-per-week.changed', {\n        org_key: org,\n        courserun_key: courseId,\n        is_staff: administrator,\n        num_days: days,\n        reminder_selected: selectReminders,\n      });\n      if (triggeredFromEmail) {\n        sendTrackEvent('enrollment.email.clicked.setgoal', {});\n      }\n    }\n  };\n\n  function handleSubscribeToReminders(event) {\n    const isGetReminderChecked = event.target.checked;\n    setGetReminderSelected(isGetReminderChecked);\n    if (!isMasquerading) { // don't save goal updates while masquerading\n      saveWeeklyLearningGoal(courseId, daysPerWeekGoal, isGetReminderChecked);\n      sendTrackEvent('edx.ui.lms.goal.reminder-selected.changed', {\n        org_key: org,\n        courserun_key: courseId,\n        is_staff: administrator,\n        num_days: daysPerWeekGoal,\n        reminder_selected: isGetReminderChecked,\n      });\n    }\n  }\n\n  useEffect(() => {\n    const currentParams = new URLSearchParams(location.search);\n    const weeklyGoal = Number(currentParams.get('weekly_goal'));\n    if ([1, 3, 5].includes(weeklyGoal)) {\n      handleSelect(weeklyGoal, true);\n\n      // Deleting the weekly_goal query param as it only needs to be set once\n      // whenever passed in query params.\n      currentParams.delete('weekly_goal');\n      history.replace({\n        search: currentParams.toString(),\n      });\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [location.search]);\n\n  return (\n    <Card\n      id=\"courseHome-weeklyLearningGoal\"\n      className=\"row w-100 m-0 mb-3 raised-card\"\n      data-testid=\"weekly-learning-goal-card\"\n    >\n      <Card.Header\n        size=\"sm\"\n        title={(<div id=\"set-weekly-goal-header\">{intl.formatMessage(messages.setWeeklyGoal)}</div>)}\n        subtitle={intl.formatMessage(messages.setWeeklyGoalDetail)}\n      />\n      <Card.Section className=\"text-gray-700 small\">\n        <div\n          role=\"radiogroup\"\n          aria-labelledby=\"set-weekly-goal-header\"\n          className=\"flag-button-container m-0 p-0\"\n        >\n          <LearningGoalButton\n            level=\"casual\"\n            isSelected={daysPerWeekGoal === 1}\n            handleSelect={handleSelect}\n          />\n          <LearningGoalButton\n            level=\"regular\"\n            isSelected={daysPerWeekGoal === 3}\n            handleSelect={handleSelect}\n          />\n          <LearningGoalButton\n            level=\"intense\"\n            isSelected={daysPerWeekGoal === 5}\n            handleSelect={handleSelect}\n          />\n        </div>\n        <div className=\"d-flex pt-3\">\n          <Form.Switch\n            checked={isGetReminderSelected}\n            onChange={(event) => handleSubscribeToReminders(event)}\n            disabled={!daysPerWeekGoal}\n          >\n            <small>{intl.formatMessage(messages.setGoalReminder)}</small>\n          </Form.Switch>\n        </div>\n      </Card.Section>\n      {isGetReminderSelected && (\n        <Card.Section muted>\n          <div className=\"row w-100 m-0 small align-center\">\n            <div className=\"d-flex align-items-center pr-1\">\n              <Icon\n                className=\"text-primary-500\"\n                src={Email}\n              />\n            </div>\n            <div className=\"col\">\n              {intl.formatMessage(messages.goalReminderDetail)}\n            </div>\n          </div>\n        </Card.Section>\n      )}\n    </Card>\n  );\n};\n\nWeeklyLearningGoalCard.propTypes = {\n  daysPerWeek: PropTypes.number,\n  subscribedToReminders: PropTypes.bool,\n  intl: intlShape.isRequired,\n};\n\nWeeklyLearningGoalCard.defaultProps = {\n  daysPerWeek: null,\n  subscribedToReminders: false,\n};\nexport default injectIntl(WeeklyLearningGoalCard);\n"],"mappings":"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"}