{"version":3,"file":"Timeline.js","names":["_react","_interopRequireDefault","require","_reactRedux","_modelStore","_Day","_utils","_jsxRuntime","obj","__esModule","default","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","value","_toPropertyKey","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","Timeline","courseId","useSelector","state","courseHome","courseDateBlocks","useModel","groupedDates","now","Date","foundNextDue","foundToday","courseDateBlock","dateInfo","parsedDate","date","isLearnerAssignment","complete","dueNext","compared","daycmp","items","first","last","jsx","className","children","map","groupedDate","_default","exports"],"sources":["../../../../src/course-home/dates-tab/timeline/Timeline.jsx"],"sourcesContent":["import React from 'react';\nimport { useSelector } from 'react-redux';\n\nimport { useModel } from '../../../generic/model-store';\n\nimport Day from './Day';\nimport { daycmp, isLearnerAssignment } from '../utils';\n\nconst Timeline = () => {\n  const {\n    courseId,\n  } = useSelector(state => state.courseHome);\n\n  const {\n    courseDateBlocks,\n  } = useModel('dates', courseId);\n\n  // Group date items by day (assuming they are sorted in first place) and add some metadata\n  const groupedDates = [];\n  const now = new Date();\n  let foundNextDue = false;\n  let foundToday = false;\n  courseDateBlocks.forEach(courseDateBlock => {\n    const dateInfo = { ...courseDateBlock };\n    const parsedDate = new Date(dateInfo.date);\n\n    if (!foundNextDue && parsedDate >= now && isLearnerAssignment(dateInfo) && !dateInfo.complete) {\n      foundNextDue = true;\n      dateInfo.dueNext = true;\n    }\n\n    if (!foundToday) {\n      const compared = daycmp(parsedDate, now);\n      if (compared === 0) {\n        foundToday = true;\n      } else if (compared > 0) {\n        foundToday = true;\n        groupedDates.push({\n          date: now,\n          items: [],\n        });\n      }\n    }\n\n    if (groupedDates.length === 0 || daycmp(groupedDates[groupedDates.length - 1].date, parsedDate) !== 0) {\n      // Add new grouped date\n      groupedDates.push({\n        date: parsedDate,\n        items: [dateInfo],\n        first: groupedDates.length === 0,\n      });\n    } else {\n      groupedDates[groupedDates.length - 1].items.push(dateInfo);\n    }\n  });\n  if (!foundToday) {\n    groupedDates.push({ date: now, items: [] });\n  }\n  if (groupedDates.length) {\n    groupedDates[groupedDates.length - 1].last = true;\n  }\n\n  return (\n    <ul className=\"list-unstyled m-0 mt-4 pt-2\">\n      {groupedDates.map((groupedDate) => (\n        <Day key={groupedDate.date} {...groupedDate} />\n      ))}\n    </ul>\n  );\n};\n\nexport default Timeline;\n"],"mappings":"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"}